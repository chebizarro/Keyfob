<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Keyfob Callback</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style> body { font-family: -apple-system, system-ui; margin: 2rem; } </style>
  </head>
  <body>
    <h1>Keyfob Callback</h1>
    <p>This window will close automatically.</p>
    <script>
      (function(){
        try {
          const hash = window.location.hash || '#';
          const cbId = hash.slice(1); // expected: keyfob-cb-*
          const params = new URLSearchParams(window.location.search);
          const payload = {};
          for (const [k,v] of params.entries()) payload[k] = v;
          window.opener && window.opener.postMessage({ __keyfob_cb__: cbId, payload }, '*');
        } catch(e) {
          // ignore
        }
        setTimeout(() => window.close(), 100);
      })();
    </script>
  </body>
</html>
